{"version":3,"sources":["../../src/index.tsx","pageConponent/Cart.js"],"names":["PayPalButton","isSdkReady","window","this","props","data","actions","currency","options","amount","shippingPreference","purchase_units","currency_code","value","application_context","shipping_preference","onSuccess","createOrder","createSubscription","onApprove","style","Button","React","ReactDOM","createOrderFn","undefined","onButtonReady","queryParams","Object","k","name","script","document","Error","Component","PropTypes","catchError","onError","clientId","merchantId","intent","commit","vault","component","disableFunding","disableCard","integrationDate","locale","buyerCountry","debug","func","Cart","userId","useSelector","state","userStatus","userInfo","_id","firestore","useFirestore","useState","cart","setCart","history","useHistory","dispatch","useDispatch","useEffect","getCartItem","a","Axios","get","nodeApiLink","withCredentials","paymentSuccessHandler","post","courses","map","course","push","collection","add","title","description","length","Date","FieldValue","serverTimestamp","seen","fetchUserData","class","minHeight","href","aria-current","key","to","src","pic","alt","width","height","university","onClick","id","removeCartItem","afterChange","filter","removeCartItemHandler","reduce","sum","price"],"mappings":"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","file":"static/js/9.57faaa05.chunk.js","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\n\ndeclare global {\n    interface Window { paypal: any }\n}\n\nexport interface PayPalButtonProps {\n    amount?: number|string,\n    currency?: number|string,\n    shippingPreference?: \"NO_SHIPPING\" | \"GET_FROM_FILE\" | \"SET_PROVIDED_ADDRESS\",\n    onSuccess?: Function,\n    catchError?: Function,\n    onError?: Function,\n    createOrder?: Function,\n    createSubscription?: Function,\n    onApprove?: Function,\n    style?: object,\n    options?: PaypalOptions,\n    onButtonReady?: Function,\n}\n\nexport interface PayPalButtonState {\n    isSdkReady: boolean\n}\n\nexport interface PaypalOptions {\n    clientId?: string,\n    merchantId?: string,\n    currency?: number|string,\n    intent?: string,\n    commit?: boolean|string,\n    vault?: boolean|string,\n    component?: string,\n    disableFunding?: string,\n    disableCard?: string,\n    integrationDate?: string,\n    locale?: string,\n    buyerCountry?: string,\n    debug?: boolean|string\n}\n\nclass PayPalButton extends React.Component<PayPalButtonProps, PayPalButtonState> {\n    static propTypes = {\n        amount: PropTypes.oneOfType([\n            PropTypes.number,\n            PropTypes.string,\n        ]),\n        currency: PropTypes.oneOfType([\n            PropTypes.number,\n            PropTypes.string,\n        ]),\n        shippingPreference: PropTypes.string,\n        onSuccess: PropTypes.func,\n        catchError: PropTypes.func,\n        onError: PropTypes.func,\n        createOrder: PropTypes.func,\n        createSubscription: PropTypes.func,\n        onApprove: PropTypes.func,\n        style: PropTypes.object,\n        options: PropTypes.shape({\n            clientId: PropTypes.string,\n            merchantId: PropTypes.string,\n            currency: PropTypes.oneOfType([\n                PropTypes.number,\n                PropTypes.string,\n            ]),\n            intent: PropTypes.string,\n            commit: PropTypes.oneOfType([\n                PropTypes.bool,\n                PropTypes.string\n            ]),\n            vault: PropTypes.oneOfType([\n                PropTypes.bool,\n                PropTypes.string\n            ]),\n            component: PropTypes.string,\n            disableFunding: PropTypes.string,\n            disableCard: PropTypes.string,\n            integrationDate: PropTypes.string,\n            locale: PropTypes.string,\n            buyerCountry: PropTypes.string,\n            debug: PropTypes.oneOfType([\n                PropTypes.bool,\n                PropTypes.string\n            ])\n        }),\n        onButtonReady: PropTypes.func,\n    }\n\n    static defaultProps = {\n        style: {},\n        options: {\n            clientId: \"sb\",\n            currency: \"USD\"\n        },\n        shippingPreference: \"GET_FROM_FILE\",\n    }\n\n    constructor(props: PayPalButtonProps) {\n        super(props);\n\n        this.state = {\n            isSdkReady: false,\n        };\n    }\n\n    componentDidMount() {\n        if (\n            typeof window !== \"undefined\" &&\n            window !== undefined &&\n            window.paypal === undefined\n        ) {\n            this.addPaypalSdk();\n        }\n        else if (\n            typeof window !== \"undefined\" &&\n            window !== undefined &&\n            window.paypal !== undefined &&\n            this.props.onButtonReady\n        ) {\n            this.props.onButtonReady();\n        }\n    }\n\n    createOrder(data: any, actions: any) {\n\n        const { currency, options, amount, shippingPreference } = this.props;\n\n        return actions.order.create({\n          purchase_units: [\n            {\n              amount: {\n                currency_code: currency\n                  ? currency\n                  : options && options.currency\n                  ? options.currency\n                  : \"USD\",\n                value: amount.toString()\n              }\n            }\n          ],\n          application_context: {\n            shipping_preference: shippingPreference\n          }\n        });\n    }\n\n    onApprove(data: any, actions: any) {\n        return actions.order\n            .capture()\n            .then((details) => {\n                if (this.props.onSuccess) {\n                    return this.props.onSuccess(details, data);\n                }\n            })\n            .catch((err) => {\n                if (this.props.catchError) {\n                    return this.props.catchError(err);\n                }\n            });\n    }\n\n    render() {\n        const {\n            amount,\n            onSuccess,\n            createOrder,\n            createSubscription,\n            onApprove,\n            style,\n        } = this.props;\n        const { isSdkReady } = this.state;\n\n        if (\n            !isSdkReady &&\n            (typeof window === \"undefined\" || window.paypal === undefined)\n        ) {\n            return null;\n        }\n\n        const Button = window.paypal.Buttons.driver(\"react\", {\n            React,\n            ReactDOM,\n        });\n\n        const createOrderFn =\n            amount && !createOrder\n                ? (data: any, actions: any) => this.createOrder(data, actions)\n                : (data: any, actions: any) => createOrder(data, actions);\n\n        return (\n            <Button\n                {...this.props}\n                createOrder={createSubscription ? undefined : createOrderFn}\n                createSubscription={createSubscription}\n                onApprove={\n                    onSuccess\n                        ? (data: any, actions: any) => this.onApprove(data, actions)\n                        : (data: any, actions: any) => onApprove(data, actions)\n                }\n                style={style}\n            />\n        );\n    }\n\n    private addPaypalSdk() {\n        const { options, onButtonReady } = this.props;\n        const queryParams: string[] = [];\n\n        // replacing camelCase with dashes\n        Object.keys(options).forEach(k => {\n            const name = k.split(/(?=[A-Z])/).join(\"-\").toLowerCase();\n            queryParams.push(`${name}=${options[k]}`);\n        });\n\n        const script = document.createElement(\"script\");\n        script.type = \"text/javascript\";\n        script.src = `https://www.paypal.com/sdk/js?${queryParams.join(\"&\")}`;\n        script.async = true;\n        script.onload = () => {\n            this.setState({ isSdkReady: true });\n\n            if (onButtonReady) {\n                onButtonReady();\n            }\n        };\n        script.onerror = () => {\n            throw new Error(\"Paypal SDK could not be loaded.\");\n        };\n    \n        document.body.appendChild(script);\n    }\n}\n\nexport { PayPalButton };\n","import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { PayPalButton } from \"react-paypal-button-v2\";\r\nimport Axios from \"axios\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { removeCartItem, fetchUserData } from \"../action/userAction\";\r\nimport { useFirestore } from \"react-redux-firebase\";\r\nimport { nodeApiLink } from \"../config/NodeServerLink\";\r\n\r\nexport const Cart = () => {\r\n    const userId = useSelector((state) => state.userStatus.userInfo && state.userStatus.userInfo._id);\r\n    const firestore = useFirestore();\r\n    const [cart, setCart] = useState([]);\r\n    const history = useHistory();\r\n    const dispatch = useDispatch();\r\n    useEffect(() => {\r\n        getCartItem();\r\n        return () => {\r\n            //\r\n        };\r\n    }, []);\r\n    const getCartItem = async () => {\r\n        const { data } = await Axios.get(`${nodeApiLink}/api/user/cart`, { withCredentials: true });\r\n        setCart(data);\r\n    };\r\n    const removeCartItemHandler = (id) => {\r\n        dispatch(removeCartItem(id));\r\n        const afterChange = cart.filter((course) => {\r\n            return course._id !== id;\r\n        });\r\n        setCart(afterChange);\r\n    };\r\n    const paymentSuccessHandler = async () => {\r\n        await Axios.post(`${nodeApiLink}/api/user/buy`, {\r\n            courses: cart.map((course) => {\r\n                return course._id;\r\n            }),\r\n        });\r\n        history.push(\"/home\");\r\n        await firestore\r\n            .collection(\"noticfications\")\r\n            .add({\r\n                userId,\r\n                title: \"Mua hàng\",\r\n                description: `bạn đã mua ${cart.length} khoá học. Hãy đến học ngay nào`,\r\n                Date: firestore.FieldValue.serverTimestamp(),\r\n                seen:false\r\n            });\r\n        dispatch(fetchUserData());\r\n    };\r\n    return (\r\n        <div class=\"content\" style={{ minHeight: 800 }}>\r\n            <div class=\"cart-header\">\r\n                <div class=\"container\">\r\n                    <div class=\"header-bar\">\r\n                        <div>\r\n                            <ol class=\"breadcrumb\">\r\n                                <li class=\"breadcrumb-item\">\r\n                                    <a href=\"#\">\r\n                                        <i class=\"fas fa-home\"></i>\r\n                                    </a>\r\n                                </li>\r\n                                <li class=\"breadcrumb-item active\" aria-current=\"page\">\r\n                                    Giỏ hàng\r\n                                </li>\r\n                            </ol>\r\n                            <h1>Thẻ mua sắm</h1>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <div class=\"space\">\r\n                    <div class=\"space-item\"></div>\r\n                </div>\r\n                <div class=\"container\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-12\">\r\n                            <h3>Có {cart.length} khoá học trong giỏ</h3>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"row\">\r\n                        <div class=\"col-8\">\r\n                            <div class=\"left\">\r\n                                {cart.map((course) => {\r\n                                    return (\r\n                                        <div class=\"course-in-cart\" key={course._id}>\r\n                                            <Link to={`/detail/${course._id}`}>\r\n                                                <div class=\"course-image\">\r\n                                                    <img src={course.pic} alt=\"\" style={{ width: 130, height: 73 }} />\r\n                                                </div>\r\n                                            </Link>\r\n                                            <div class=\"course-info\">\r\n                                                <Link to={`/detail/${course._id}`} class=\"item\">\r\n                                                    {course.title}\r\n                                                </Link>\r\n                                                <Link to=\"/partner\" class=\"author-name\">\r\n                                                    {course.university}\r\n                                                </Link>\r\n                                            </div>\r\n                                            <div class=\"course-remove\">\r\n                                                <a\r\n                                                    onClick={() => {\r\n                                                        removeCartItemHandler(course._id);\r\n                                                    }}\r\n                                                >\r\n                                                    Bỏ khỏi giỏ hàng\r\n                                                </a>\r\n                                                <Link to={`/detail/${course._id}`}>Đi đến khóa học</Link>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                                {/* <div class=\"course-in-cart\">\r\n                                    <a href=\"Thongtinkhoahoc.html\">\r\n                                        <div class=\"course-image\">\r\n                                            <img src=\"artkh.jpg\" alt=\"\" style={{ width: 130, height: 73 }} />\r\n                                        </div>\r\n                                    </a>\r\n\r\n                                    <div class=\"course-price\">\r\n                                        <span>500.000đ</span>\r\n                                        <i style={{ marginLeft: 7 }} class=\"fas fa-tag\"></i>\r\n                                    </div>\r\n                                </div> */}\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-4\">\r\n                            <div class=\"right\">\r\n                                <div class=\"price-text\">\r\n                                    <div class=\"total\">Tổng hóa đơn:</div>\r\n                                    <div class=\"price-large\">\r\n                                        {cart?.length\r\n                                            ? cart.reduce((sum, course) => {\r\n                                                  return sum + course.price;\r\n                                              }, 0)\r\n                                            : 0}{\" \"}\r\n                                        VND\r\n                                    </div>\r\n                                    <div class=\"space\"></div>\r\n                                    <PayPalButton\r\n                                        amount={\r\n                                            cart?.length\r\n                                                ? cart.reduce((sum = 0, course) => {\r\n                                                      return sum + course.price;\r\n                                                  }, 0)\r\n                                                : 0\r\n                                        }\r\n                                        onSuccess={paymentSuccessHandler}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\nexport default Cart"],"sourceRoot":""}